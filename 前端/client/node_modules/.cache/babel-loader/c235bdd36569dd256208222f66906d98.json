{"ast":null,"code":"import DialogFound from '../components/DialogFound';\nexport default {\n  name: 'fundlist',\n\n  data() {\n    return {\n      tableData: [],\n      allTableData: [],\n      filterTableData: [],\n      dialog: {\n        show: false,\n        title: '',\n        option: 'edit'\n      },\n      form: {\n        type: '',\n        describe: '',\n        income: '',\n        expend: '',\n        cash: '',\n        remark: '',\n        id: ''\n      },\n      //需要给分页组件传的信息\n      paginations: {\n        page_index: 1,\n        // 当前位于哪页\n        total: 0,\n        // 总数\n        page_size: 5,\n        // 1页显示多少条\n        page_sizes: [5, 10, 15, 20],\n        //每页显示多少条\n        layout: 'total, sizes, prev, pager, next, jumper' // 翻页属性\n\n      },\n      search_data: {\n        startTime: '',\n        endTime: ''\n      }\n    };\n  },\n\n  components: {\n    DialogFound\n  },\n\n  created() {\n    this.getProfile();\n  },\n\n  methods: {\n    getProfile() {\n      // 获取表格数据\n      this.$axios.post('/profiles').then(res => {\n        console.log(res.data);\n        this.tableData = res.data;\n        this.allTableData = res.data;\n        this.filterTableData = res.data; // 设置分页数据\n\n        this.setPaginations();\n      });\n    },\n\n    onEditMoney(row) {\n      // 编辑\n      this.dialog = {\n        show: true,\n        title: '修改资金信息',\n        option: 'edit'\n      };\n      this.form = {\n        type: row.type,\n        describe: row.describe,\n        income: row.income,\n        expend: row.expend,\n        cash: row.cash,\n        remark: row.remark,\n        id: row._id\n      };\n    },\n\n    onDeleteMoney(row, index) {\n      // 删除\n      this.$axios.delete(`/api/profiles/delete/${row._id}`).then(res => {\n        this.$message('删除成功');\n        this.getProfile();\n      });\n    },\n\n    onAddMoney() {\n      // 添加\n      this.dialog = {\n        show: true,\n        title: '添加资金信息',\n        option: 'add'\n      };\n      this.form = {\n        type: '',\n        describe: '',\n        income: '',\n        expend: '',\n        cash: '',\n        remark: '',\n        id: ''\n      };\n    },\n\n    handleCurrentChange(page) {\n      // 当前页\n      let sortnum = this.paginations.page_size * (page - 1);\n      let table = this.allTableData.filter((item, index) => {\n        return index >= sortnum;\n      }); // 设置默认分页数据\n\n      this.tableData = table.filter((item, index) => {\n        return index < this.paginations.page_size;\n      });\n    },\n\n    handleSizeChange(page_size) {\n      // 切换size\n      this.paginations.page_index = 1;\n      this.paginations.page_size = page_size;\n      this.tableData = this.allTableData.filter((item, index) => {\n        return index < page_size;\n      });\n    },\n\n    setPaginations() {\n      // 总页数\n      this.paginations.total = this.allTableData.length;\n      this.paginations.page_index = 1;\n      this.paginations.page_size = 5; // 设置默认分页数据\n\n      this.tableData = this.allTableData.filter((item, index) => {\n        return index < this.paginations.page_size;\n      });\n    },\n\n    onScreeoutMoney() {\n      // 筛选\n      if (!this.search_data.startTime || !this.search_data.endTime) {\n        this.$message({\n          type: 'warning',\n          message: '请选择时间区间'\n        });\n        this.getProfile();\n        return;\n      }\n\n      const stime = this.search_data.startTime.getTime();\n      const etime = this.search_data.endTime.getTime();\n      this.allTableData = this.filterTableData.filter(item => {\n        let date = new Date(item.date);\n        let time = date.getTime();\n        return time >= stime && time <= etime;\n      }); // 分页数据\n\n      this.setPaginations();\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAsFA;AAEA;EACAA,gBADA;;EAEAC;IACA;MACAC,aADA;MAEAC,gBAFA;MAGAC,mBAHA;MAIAC;QACAC,WADA;QAEAC,SAFA;QAGAC;MAHA,CAJA;MASAC;QACAC,QADA;QAEAC,YAFA;QAGAC,UAHA;QAIAC,UAJA;QAKAC,QALA;QAMAC,UANA;QAOAC;MAPA,CATA;MAkBA;MACAC;QACAC,aADA;QACA;QACAC,QAFA;QAEA;QACAC,YAHA;QAGA;QACAC,2BAJA;QAIA;QACAC,iDALA,CAKA;;MALA,CAnBA;MA0BAC;QACAC,aADA;QAEAC;MAFA;IA1BA;EA+BA,CAlCA;;EAmCAC;IACAC;EADA,CAnCA;;EAsCAC;IACA;EACA,CAxCA;;EAyCAC;IACAC;MACA;MACA;QACAC;QACA;QACA;QACA,gCAJA,CAKA;;QACA;MACA,CAPA;IAQA,CAXA;;IAYAC;MACA;MACA;QACA1B,UADA;QAEAC,eAFA;QAGAC;MAHA;MAKA;QACAE,cADA;QAEAC,sBAFA;QAGAC,kBAHA;QAIAC,kBAJA;QAKAC,cALA;QAMAC,kBANA;QAOAC;MAPA;IASA,CA5BA;;IA6BAiB;MACA;MACA;QACA;QACA;MACA,CAHA;IAIA,CAnCA;;IAoCAC;MACA;MACA;QACA5B,UADA;QAEAC,eAFA;QAGAC;MAHA;MAKA;QACAE,QADA;QAEAC,YAFA;QAGAC,UAHA;QAIAC,UAJA;QAKAC,QALA;QAMAC,UANA;QAOAC;MAPA;IASA,CApDA;;IAqDAmB;MACA;MACA;MACA;QACA;MACA,CAFA,EAHA,CAMA;;MACA;QACA;MACA,CAFA;IAGA,CA/DA;;IAgEAC;MACA;MACA;MACA;MACA;QACA;MACA,CAFA;IAGA,CAvEA;;IAwEAC;MACA;MACA;MACA;MACA,+BAJA,CAKA;;MACA;QACA;MACA,CAFA;IAGA,CAjFA;;IAkFAC;MACA;MACA;QACA;UACA5B,eADA;UAEA6B;QAFA;QAIA;QACA;MACA;;MACA;MACA;MACA;QACA;QACA;QACA;MACA,CAJA,EAZA,CAiBA;;MACA;IACA;;EArGA;AAzCA","names":["name","data","tableData","allTableData","filterTableData","dialog","show","title","option","form","type","describe","income","expend","cash","remark","id","paginations","page_index","total","page_size","page_sizes","layout","search_data","startTime","endTime","components","DialogFound","created","methods","getProfile","console","onEditMoney","onDeleteMoney","onAddMoney","handleCurrentChange","handleSizeChange","setPaginations","onScreeoutMoney","message"],"sourceRoot":"src/views","sources":["FoundList.vue"],"sourcesContent":["<template>\r\n  <div class=\"fillcontain\">\r\n    <div>\r\n      <el-form :inline=\"true\" ref=\"search_data\" :model=\"search_data\">\r\n        <el-form-item label=\"投标时间筛选:\">\r\n          <el-date-picker v-model=\"search_data.startTime\" type=\"datetime\" placeholder=\"选择开始时间\"></el-date-picker>--\r\n          <el-date-picker v-model=\"search_data.endTime\" type=\"datetime\" placeholder=\"选择结束时间\"></el-date-picker>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"primary\" size=\"small\" icon=\"search\" @click=\"onScreeoutMoney()\">筛选</el-button>\r\n        </el-form-item>\r\n        <el-form-item class=\"btnRight\">\r\n          <el-button type=\"primary\" size=\"small\" icon=\"view\" @click=\"onAddMoney()\">添加</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </div>\r\n    <div class=\"table_container\">\r\n      <el-table\r\n        v-if=\"tableData.length > 0\"\r\n        :data=\"tableData\"\r\n        max-height=\"450\"\r\n        border\r\n        :default-sort=\"{ prop: 'date', order: 'descending' }\"\r\n        style=\"width: 100%\"\r\n      >\r\n        <el-table-column type=\"index\" label=\"序号\" align=\"center\" width=\"70\"></el-table-column>\r\n        <el-table-column prop=\"date\" label=\"创建时间\" align=\"center\" width=\"250\" sortable>\r\n          <template slot-scope=\"scope\">\r\n            <el-icon name=\"time\"></el-icon>\r\n            <span style=\"margin-left: 10px\">{{ scope.row.date }}</span>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"type\" label=\"收支类型\" align=\"center\" width=\"150\"></el-table-column>\r\n        <el-table-column prop=\"describe\" label=\"收支描述\" align=\"center\" width=\"180\"></el-table-column>\r\n        <el-table-column prop=\"income\" label=\"收入\" align=\"center\" width=\"170\">\r\n          <template slot-scope=\"scope\">\r\n            <span style=\"color: #00d053\">+ {{ scope.row.income }}</span>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"expend\" label=\"支出\" align=\"center\" width=\"170\">\r\n          <template slot-scope=\"scope\">\r\n            <span style=\"color: #f56767\">- {{ scope.row.expend }}</span>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"cash\" label=\"账户现金\" align=\"center\" width=\"170\">\r\n          <template slot-scope=\"scope\">\r\n            <span style=\"color: #4db3ff\">{{ scope.row.cash }}</span>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"remark\" label=\"备注\" align=\"center\" width=\"220\"></el-table-column>\r\n        <el-table-column prop=\"operation\" align=\"center\" label=\"操作\" fixed=\"right\" width=\"180px\">\r\n          <template slot-scope=\"scope\">\r\n            <el-button type=\"warning\" icon=\"edit\" size=\"small\" @click=\"onEditMoney(scope.row)\">编辑</el-button>\r\n            <el-button\r\n              type=\"danger\"\r\n              icon=\"delete\"\r\n              size=\"small\"\r\n              @click=\"onDeleteMoney(scope.row, scope.$index)\"\r\n            >删除</el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      <!-- 分页 -->\r\n      <el-row>\r\n        <el-col :span=\"24\">\r\n          <div class=\"pagination\">\r\n            <el-pagination\r\n              v-if=\"paginations.total > 0\"\r\n              :page-sizes=\"paginations.page_sizes\"\r\n              :page-size=\"paginations.page_size\"\r\n              :layout=\"paginations.layout\"\r\n              :total=\"paginations.total\"\r\n              :current-page.sync=\"paginations.page_index\"\r\n              @current-change=\"handleCurrentChange\"\r\n              @size-change=\"handleSizeChange\"\r\n            ></el-pagination>\r\n          </div>\r\n        </el-col>\r\n      </el-row>\r\n    </div>\r\n    <!-- 弹框页面 -->\r\n    <DialogFound :dialog=\"dialog\" :form=\"form\" @update=\"getProfile\"></DialogFound>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport DialogFound from '../components/DialogFound'\r\n\r\nexport default {\r\n  name: 'fundlist',\r\n  data() {\r\n    return {\r\n      tableData: [],\r\n      allTableData: [],\r\n      filterTableData: [],\r\n      dialog: {\r\n        show: false,\r\n        title: '',\r\n        option: 'edit',\r\n      },\r\n      form: {\r\n        type: '',\r\n        describe: '',\r\n        income: '',\r\n        expend: '',\r\n        cash: '',\r\n        remark: '',\r\n        id: '',\r\n      },\r\n      //需要给分页组件传的信息\r\n      paginations: {\r\n        page_index: 1, // 当前位于哪页\r\n        total: 0, // 总数\r\n        page_size: 5, // 1页显示多少条\r\n        page_sizes: [5, 10, 15, 20], //每页显示多少条\r\n        layout: 'total, sizes, prev, pager, next, jumper', // 翻页属性\r\n      },\r\n      search_data: {\r\n        startTime: '',\r\n        endTime: '',\r\n      },\r\n    }\r\n  },\r\n  components: {\r\n    DialogFound,\r\n  },\r\n  created() {\r\n    this.getProfile()\r\n  },\r\n  methods: {\r\n    getProfile() {\r\n      // 获取表格数据\r\n      this.$axios.post('/profiles').then((res) => {\r\n        console.log(res.data)\r\n        this.tableData = res.data\r\n        this.allTableData = res.data\r\n        this.filterTableData = res.data\r\n        // 设置分页数据\r\n        this.setPaginations()\r\n      })\r\n    },\r\n    onEditMoney(row) {\r\n      // 编辑\r\n      this.dialog = {\r\n        show: true,\r\n        title: '修改资金信息',\r\n        option: 'edit',\r\n      }\r\n      this.form = {\r\n        type: row.type,\r\n        describe: row.describe,\r\n        income: row.income,\r\n        expend: row.expend,\r\n        cash: row.cash,\r\n        remark: row.remark,\r\n        id: row._id,\r\n      }\r\n    },\r\n    onDeleteMoney(row, index) {\r\n      // 删除\r\n      this.$axios.delete(`/api/profiles/delete/${row._id}`).then((res) => {\r\n        this.$message('删除成功')\r\n        this.getProfile()\r\n      })\r\n    },\r\n    onAddMoney() {\r\n      // 添加\r\n      this.dialog = {\r\n        show: true,\r\n        title: '添加资金信息',\r\n        option: 'add',\r\n      }\r\n      this.form = {\r\n        type: '',\r\n        describe: '',\r\n        income: '',\r\n        expend: '',\r\n        cash: '',\r\n        remark: '',\r\n        id: '',\r\n      }\r\n    },\r\n    handleCurrentChange(page) {\r\n      // 当前页\r\n      let sortnum = this.paginations.page_size * (page - 1)\r\n      let table = this.allTableData.filter((item, index) => {\r\n        return index >= sortnum\r\n      })\r\n      // 设置默认分页数据\r\n      this.tableData = table.filter((item, index) => {\r\n        return index < this.paginations.page_size\r\n      })\r\n    },\r\n    handleSizeChange(page_size) {\r\n      // 切换size\r\n      this.paginations.page_index = 1\r\n      this.paginations.page_size = page_size\r\n      this.tableData = this.allTableData.filter((item, index) => {\r\n        return index < page_size\r\n      })\r\n    },\r\n    setPaginations() {\r\n      // 总页数\r\n      this.paginations.total = this.allTableData.length\r\n      this.paginations.page_index = 1\r\n      this.paginations.page_size = 5\r\n      // 设置默认分页数据\r\n      this.tableData = this.allTableData.filter((item, index) => {\r\n        return index < this.paginations.page_size\r\n      })\r\n    },\r\n    onScreeoutMoney() {\r\n      // 筛选\r\n      if (!this.search_data.startTime || !this.search_data.endTime) {\r\n        this.$message({\r\n          type: 'warning',\r\n          message: '请选择时间区间',\r\n        })\r\n        this.getProfile()\r\n        return\r\n      }\r\n      const stime = this.search_data.startTime.getTime()\r\n      const etime = this.search_data.endTime.getTime()\r\n      this.allTableData = this.filterTableData.filter((item) => {\r\n        let date = new Date(item.date)\r\n        let time = date.getTime()\r\n        return time >= stime && time <= etime\r\n      })\r\n      // 分页数据\r\n      this.setPaginations()\r\n    },\r\n  },\r\n}\r\n</script>\r\n<style scoped>\r\n.fillcontain {\r\n  width: 100%;\r\n  height: 100%;\r\n  padding: 16px;\r\n  box-sizing: border-box;\r\n}\r\n.btnRight {\r\n  float: right;\r\n}\r\n.pagination {\r\n  text-align: right;\r\n  margin-top: 10px;\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}